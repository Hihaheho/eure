// Test cases for map type schemas

// ============================================================================
// Valid Cases
// ============================================================================

// ============================================================================
// Test Case 1: Basic map with string keys
// ============================================================================

@ cases.string-keys-valid
input_eure = ```eure
data = { "a" => 1, "b" => 2 }
```

schema = ```eure
data {
  $variant = "map"
  key = `text`
  value = `integer`
}
```

// ============================================================================
// Test Case 2: Map with integer keys
// ============================================================================

@ cases.integer-keys-valid
input_eure = ```eure
data = { 1 => "one", 2 => "two" }
```

schema = ```eure
data {
  $variant = "map"
  key = `integer`
  value = `text`
}
```

// ============================================================================
// Error Cases
// ============================================================================

// ============================================================================
// Test Case 3: Invalid key type (string key when integer expected)
// ============================================================================

@ cases.invalid-key-type
input_eure = ```eure
data = { "string-key" => 1 }
outer = {
  data."string-key".inner => 1
  data.ident-key.inner => 1
}
```

schema = ```eure
data {
  $variant = "map"
  key = `integer`
  value = `integer`
}
outer {
  data {
    $variant = "map"
    key = `integer`
    value = { inner => `integer` }
  }
}
```

schema_errors[] = ```text
error: Invalid key type at path data
 --> <input>:1:10
  |
1 | data = { "string-key" => 1 }
  |          ^^^^^^^^^^^^ Invalid key type at path data
  |
note: constraint defined here
 --> <schema>:1:1
  |
1 | / data {
2 | |   $variant = "map"
3 | |   key = `integer`
4 | |   value = `integer`
5 | | }
  | |_- constraint defined here
```

schema_errors[] = ```text
error: Invalid key type at path outer.data
  --> <input>:3:8
   |
 3 |   data."string-key".inner => 1
   |        ^^^^^^^^^^^^ Invalid key type at path outer.data
   |
note: constraint defined here
  --> <schema>:7:3
   |
 7 | /   data {
 8 | |     $variant = "map"
 9 | |     key = `integer`
10 | |     value = { inner => `integer` }
11 | |   }
   | |___- constraint defined here
```

schema_errors[] = ```text
error: Invalid key type at path outer.data
  --> <input>:4:8
   |
 4 |   data.ident-key.inner => 1
   |        ^^^^^^^^^ Invalid key type at path outer.data
   |
note: constraint defined here
  --> <schema>:7:3
   |
 7 | /   data {
 8 | |     $variant = "map"
 9 | |     key = `integer`
10 | |     value = { inner => `integer` }
11 | |   }
   | |___- constraint defined here
```
